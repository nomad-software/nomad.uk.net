<!DOCTYPE HTML>
<html>
	<head>
					<title>nomad software | How to sort collections of custom types in C#</title>
		
		<meta name="author" content="Gary Willoughby">
		<meta name="description" content="Iâ€™ve recently created a program which sorts collections of custom types quite extensively and I thought iâ€™d share the standard method of doing this.">
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta http-equiv="Expires" content="7" />

		<link rel="shortcut icon" href="/nomad.uk.net/favicon.ico" />
		<link rel="stylesheet" type="text/css" href="/nomad.uk.net/css/site.css">
		<link rel="stylesheet" type="text/css" href="/nomad.uk.net/css/gist.css">
		<link rel="stylesheet" type="text/css" href="/nomad.uk.net/css/disqus.css">

		<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-111284073-1" defer></script>
		<script type="text/javascript" defer>
			window.dataLayer = window.dataLayer || [];
			function gtag(){
				dataLayer.push(arguments);
			}
			gtag('js', new Date());
			gtag('config', 'UA-111284073-1');
		</script>
	</head>
	<body>
		<header>
			<div class="content">
				<table>
					<tr>
						<td class="logo">
							<a href="/nomad.uk.net/"><h1>nomad<span class="highlight">software</span></h1></a>
						</td>
						<td class="links">
							<a title="Twitter" href="https://twitter.com/nomaddeveloper" target="_blank"><img src="images/header/twitter.png" alt="Twitter"></a>
							<a title="Linkedin" href="http://uk.linkedin.com/pub/gary-willoughby/63/489/33b" target="_blank"><img src="images/header/linkedin.png" alt="Linkedin"></a>
							<a title="Github" href="https://github.com/nomad-software" target="_blank"><img src="images/header/github.png" alt="Github"></a>
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<div class="nav-bar">
								<ul>
									<li><a href="/nomad.uk.net/"><img src="/nomad.uk.net/images/header/home.png" /></a></li>
									<li><a href="/nomad.uk.net/pages/about.html">About</a></li>
									<li><a href="/nomad.uk.net/pages/archive.html">Archive</a></li>
								</ul>
							</div>
						</td>
					</tr>
				</table>
			</div>
		</header>

		<div class="body">
			<div class="content">
				<p><img src="/nomad.uk.net/articles/images/how-to-sort-collections-of-custom-types-in-c-sharp-banner.jpg" /></p>
<h1 id="how-to-sort-collections-of-custom-types-in-c">How to sort collections of custom types in C</h1>
<p><time>Posted on 20th March 2010 by <a href="/nomad.uk.net/pages/about.html">Gary Willoughby</a></time></p>
<p>Iâ€™ve recently created a program which sorts collections of custom types quite extensively and I thought iâ€™d share the standard method of doing this. When I first started designing my program, I honestly thought it would be quite a pain sorting these collections but I was pleasantly surprised, as usual by the .NET framework, that there are built in shortcuts.</p>
<h2 id="icomparable">IComparable</h2>
<p>The first stage to allow a custom type to be sorted is to implement the IComparable interface. This consists of one method <code>CompareTo&lt;T&gt;</code> where T is your custom type. This becomes your default comparer.</p>
<p>Hereâ€™s an example:</p>
<script src="https://gist.github.com/nomad-software/a5167f6b866338cd9dcb243f5e982ee0.js"></script>
<p>Once that method is implemented (here weâ€™ve implemented it using the name field to compare against) you can use the native sort methods on a collection of such types and have them sorted via this default comparer. For example if you are using an array as your collection, you can use the default static â€˜Sortâ€™ method to sort it:</p>
<script src="https://gist.github.com/nomad-software/7e54b8618213bd736ecd525078dddf81.js"></script>
<p>If you are using a generic list you can use the built in â€˜Sortâ€™ method:</p>
<script src="https://gist.github.com/nomad-software/33715f7cacbe80fbaed90d49881a5343.js"></script>
<p>Again this uses the default comparer and sorts the collection by the name field.</p>
<h2 id="comparison">Comparison</h2>
<p>If you need to give the user the option of multiple ways of sorting your collection you must implement other comparers. This is achieved by implementing Comparison delegates. Letâ€™s implement some in our custom type to allow sorting of every field:</p>
<script src="https://gist.github.com/nomad-software/c393b614afe0541b464b6388324ae920.js"></script>
<p>Here, as well as the default comparer, we have implemented three Comparison delegates to provide the rules of sorting the three fields in the custom type. They have been made static so you can use them without referring to an instance of the custom type.</p>
<p>Here is an example of sorting an array of our custom type by the Age field.</p>
<script src="https://gist.github.com/nomad-software/148edbfd338be90d9071c97ce875f9f8.js"></script>
<p>and here is how you sort a generic list collection by the Age field:</p>
<script src="https://gist.github.com/nomad-software/3701599a4aaf8d80c9a9d4d8dc18002d.js"></script>
<p>Simple.</p>
<p>Hopefully this gives you good grounding on sorting custom type collections and although there are other ways of sorting available in the .NET framework, these are the most common.</p>
<hr />
															<div id="disqus_thread" class="disqus"></div>
						<script type="text/javascript" defer>
							var disqus_config = function() {
								this.page.url        = "http://nomad.uk.net/articles/how-to-sort-collections-of-custom-types-in-c-sharp.html";
								this.page.identifier = "6925fb89104afccfac623c5262b6ff6a";
							};

							(function() {
								var d = document;
								var s = d.createElement('script');
								s.src = 'https://nomad-software.disqus.com/embed.js';
								s.setAttribute('data-timestamp', +new Date());
								(d.head || d.body).appendChild(s);
							})();
						</script>
												</div>
		</div>

		<footer>
			<div class="content">
				<table>
					<tr>
						<td>
							<img src="images/footer/portrait.jpg" class="thumb" />
						</td>
						<td>
							<p class="author">
								<strong>Author: Gary Willoughby</strong><br>
								Software engineer and published author with over twenty years experience of software design and development.
							</p>

							<div class="links">
								<a title="Twitter" href="https://twitter.com/nomaddeveloper" target="_blank"><img src="images/header/twitter.png" alt="Twitter"></a>
								<a title="Linkedin" href="http://uk.linkedin.com/pub/gary-willoughby/63/489/33b" target="_blank"><img src="images/header/linkedin.png" alt="Linkedin"></a>
								<a title="Github" href="https://github.com/nomad-software" target="_blank"><img src="images/header/github.png" alt="Github"></a>
							</div>

							<p class="copyright">
								Content copyright &copy; <script type="text/javascript">document.write(new Date().getFullYear());</script> Gary Willoughby All Rights Reserved.
								All source code is public domain and provided "as is", so use at your own risk.
								All content previously appeared at <a href="http://nomad.so/" target="_blank">www.nomad.so</a> and carefully migrated here because the somalis wanted their domain back! ðŸ˜ž
							</p>
						</td>
					</tr>
				</table>
			</div>
		</footer>
	</body>
</html>
